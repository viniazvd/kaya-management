{"version":3,"sources":["auth.test.js"],"names":["require","config","isValid","encrypt","test","models","beforeEach","t","Client","destroy","truncate","after","always","serial","user","name","email","password","newUser","build","result","save","is","dataValues","passwordEncrypted","isMatch"],"mappings":";;AAAAA,QAAQ,QAAR,EAAkBC,MAAlB;;AAEA,MAAMC,UAAUF,QAAQ,oCAAR,CAAhB;AACA,MAAMG,UAAUH,QAAQ,0BAAR,CAAhB;AACA,MAAMI,OAAOJ,QAAQ,KAAR,CAAb;AACA,MAAMK,SAASL,QAAQ,iCAAR,CAAf;;AAEAI,KAAKE,UAAL,CAAgBC,KAAKF,OAAOG,MAAP,CAAcC,OAAd,CAAsB,EAACC,UAAU,IAAX,EAAtB,CAArB;AACAN,KAAKO,KAAL,CAAWC,MAAX,CAAkBL,KAAKF,OAAOG,MAAP,CAAcC,OAAd,CAAsB,EAACC,UAAU,IAAX,EAAtB,CAAvB;;AAEAN,KAAKS,MAAL,CAAY,QAAZ,EAAsB,MAAMN,CAAN,IAAW;AAC/B,QAAMO,OAAO,EAAEC,MAAM,UAAR,EAAoBC,OAAO,qBAA3B,EAAkDC,UAAU,KAA5D,EAAb;AACA,QAAMC,UAAU,MAAMb,OAAOG,MAAP,CAAcW,KAAd,CAAoBL,IAApB,CAAtB;AACA,QAAMM,SAAS,MAAMF,QAAQG,IAAR,EAArB;;AAEAd,IAAEe,EAAF,CAAKF,OAAOG,UAAP,CAAkBP,KAAvB,EAA8B,qBAA9B;AACD,CAND;;AAQAZ,KAAKS,MAAL,CAAY,QAAZ,EAAsB,MAAMN,CAAN,IAAW;AAC/B,QAAMiB,oBAAoB,MAAMrB,QAAQ,KAAR,CAAhC;AACA,QAAMW,OAAO,EAAEC,MAAM,UAAR,EAAoBC,OAAO,qBAA3B,EAAkDC,UAAUO,iBAA5D,EAAb;AACA,QAAMN,UAAU,MAAMb,OAAOG,MAAP,CAAcW,KAAd,CAAoBL,IAApB,CAAtB;AACA,QAAMM,SAAS,MAAMF,QAAQG,IAAR,EAArB;;AAEA,QAAMI,UAAU,MAAMvB,QAAQ,KAAR,EAAeY,KAAKG,QAApB,CAAtB;;AAEAV,IAAEe,EAAF,CAAKF,OAAOG,UAAP,CAAkBP,KAAvB,EAA8B,qBAA9B;AACAT,IAAEe,EAAF,CAAKG,OAAL,EAAc,IAAd;AACD,CAVD","file":"auth.test.js","sourcesContent":["require('dotenv').config()\n\nconst isValid = require('../../../support/compare-passwords')\nconst encrypt = require('../../../support/encrypt')\nconst test = require('ava')\nconst models = require('../../../infra/sequelize/models')\n\ntest.beforeEach(t => models.Client.destroy({truncate: true}))\ntest.after.always(t => models.Client.destroy({truncate: true}))\n\ntest.serial('signup', async t => {\n  const user = { name: 'vinitest', email: 'emailtest@gmail.com', password: '123' }\n  const newUser = await models.Client.build(user)\n  const result = await newUser.save()\n\n  t.is(result.dataValues.email, 'emailtest@gmail.com')\n})\n\ntest.serial('signin', async t => {\n  const passwordEncrypted = await encrypt('123')\n  const user = { name: 'vinitest', email: 'emailtest@gmail.com', password: passwordEncrypted }\n  const newUser = await models.Client.build(user)\n  const result = await newUser.save()\n\n  const isMatch = await isValid('123', user.password)\n\n  t.is(result.dataValues.email, 'emailtest@gmail.com')\n  t.is(isMatch, true)\n})\n"]}