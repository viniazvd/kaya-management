{"version":3,"sources":["auth.test.js"],"names":["require","config","isValid","encrypt","test","models","beforeEach","t","Client","destroy","truncate","cascade","after","always","serial","user","name","email","password","newUser","build","result","save","is","dataValues","passwordEncrypted","isMatch"],"mappings":";;AAAAA,QAAQ,QAAR,EAAkBC,MAAlB;;AAEA,MAAMC,UAAUF,QAAQ,oCAAR,CAAhB;AACA,MAAMG,UAAUH,QAAQ,0BAAR,CAAhB;AACA,MAAMI,OAAOJ,QAAQ,KAAR,CAAb;AACA,MAAMK,SAASL,QAAQ,iCAAR,CAAf;;AAEAI,KAAKE,UAAL,CAAgBC,KAAKF,OAAOG,MAAP,CAAcC,OAAd,CAAsB,EAAEC,UAAU,IAAZ,EAAkBC,SAAS,IAA3B,EAAtB,CAArB;AACAP,KAAKQ,KAAL,CAAWC,MAAX,CAAkBN,KAAKF,OAAOG,MAAP,CAAcC,OAAd,CAAsB,EAAEC,UAAU,IAAZ,EAAkBC,SAAS,IAA3B,EAAtB,CAAvB;;AAEAP,KAAKU,MAAL,CAAY,QAAZ,EAAsB,MAAMP,CAAN,IAAW;AAC/B,QAAMQ,OAAO,EAAEC,MAAM,UAAR,EAAoBC,OAAO,qBAA3B,EAAkDC,UAAU,KAA5D,EAAb;AACA,QAAMC,UAAU,MAAMd,OAAOG,MAAP,CAAcY,KAAd,CAAoBL,IAApB,CAAtB;AACA,QAAMM,SAAS,MAAMF,QAAQG,IAAR,EAArB;;AAEAf,IAAEgB,EAAF,CAAKF,OAAOG,UAAP,CAAkBP,KAAvB,EAA8B,qBAA9B;AACD,CAND;;AAQAb,KAAKU,MAAL,CAAY,QAAZ,EAAsB,MAAMP,CAAN,IAAW;AAC/B,QAAMkB,oBAAoB,MAAMtB,QAAQ,KAAR,CAAhC;AACA,QAAMY,OAAO,EAAEC,MAAM,UAAR,EAAoBC,OAAO,qBAA3B,EAAkDC,UAAUO,iBAA5D,EAAb;AACA,QAAMN,UAAU,MAAMd,OAAOG,MAAP,CAAcY,KAAd,CAAoBL,IAApB,CAAtB;AACA,QAAMM,SAAS,MAAMF,QAAQG,IAAR,EAArB;;AAEA,QAAMI,UAAU,MAAMxB,QAAQ,KAAR,EAAea,KAAKG,QAApB,CAAtB;;AAEAX,IAAEgB,EAAF,CAAKF,OAAOG,UAAP,CAAkBP,KAAvB,EAA8B,qBAA9B;AACAV,IAAEgB,EAAF,CAAKG,OAAL,EAAc,IAAd;AACD,CAVD","file":"auth.test.js","sourcesContent":["require('dotenv').config()\n\nconst isValid = require('../../../support/compare-passwords')\nconst encrypt = require('../../../support/encrypt')\nconst test = require('ava')\nconst models = require('../../../infra/sequelize/models')\n\ntest.beforeEach(t => models.Client.destroy({ truncate: true, cascade: true }))\ntest.after.always(t => models.Client.destroy({ truncate: true, cascade: true }))\n\ntest.serial('signup', async t => {\n  const user = { name: 'vinitest', email: 'emailtest@gmail.com', password: '123' }\n  const newUser = await models.Client.build(user)\n  const result = await newUser.save()\n\n  t.is(result.dataValues.email, 'emailtest@gmail.com')\n})\n\ntest.serial('signin', async t => {\n  const passwordEncrypted = await encrypt('123')\n  const user = { name: 'vinitest', email: 'emailtest@gmail.com', password: passwordEncrypted }\n  const newUser = await models.Client.build(user)\n  const result = await newUser.save()\n\n  const isMatch = await isValid('123', user.password)\n\n  t.is(result.dataValues.email, 'emailtest@gmail.com')\n  t.is(isMatch, true)\n})\n"]}